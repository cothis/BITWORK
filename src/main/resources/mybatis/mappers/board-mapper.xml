<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="board">

	<!-- 전체 게시글 수 조회 -->
	<select id="totalCount" resultType="int">
		SELECT COUNT(*) AS CNT FROM BOARD
	</select>

	<!-- 페이지에 표시할 데이터 조회
		parameterType="Map" : begin, end 값 전달 용도
		key-value 형태의 Map 사용 바인드변수명 key가 됨 -->
	<select id="list" resultType="com.bitwork.board.vo.BoardVO" parameterType="Map">
		SELECT *
          FROM (SELECT ROWNUM AS R_NUM, B.*
                  FROM (SELECT BOARD_IDX, SUBJECT, NAME, B.REGDATE, HIT
                          FROM BOARD B, MEMBER M
                         WHERE B.MEMBER_ID = M.ID
            	         ORDER BY STATUS DESC, BOARD_IDX DESC
                       ) B
               )
         WHERE R_NUM BETWEEN #{begin} AND #{end}	 
	</select>
	
	<!-- 게시글 하나 조회 (BOARD_IDX 값으로) -->
	<select id="one" parameterType="String" resultType="com.bitwork.board.vo.BoardVO">
		SELECT B.*
          FROM (SELECT BOARD_IDX, NAME, POSITION, HIT, B.REGDATE, SUBJECT, CONTENT, B.FILE_NAME, B.ORI_NAME
                  FROM BOARD B, MEMBER M
                 WHERE B.MEMBER_ID = M.ID
               ) B
         WHERE BOARD_IDX = #{board_idx}	  
	</select> 
</mapper>